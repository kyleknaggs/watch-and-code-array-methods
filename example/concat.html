<script src="../simpletest.js"></script>
<script>
  // Summary:
  // Used to merge two or more arrays.

  // Prototype implementation:

  // var testArray = [1, 2, 3];
  // var testValue1 = 4;
  // var testValue2 = 5;

  // function concat(originalArray, values) {
  //   var resultSoFar = originalArray;
  //   for (var i = 1; i < arguments.length; i++) {
  //     testArray.push(arguments[i]);
  //   }
  //   return resultSoFar;
  // }

  // concat(testArray, testValue1, testValue2, testValue3, testValue4);

  // Function signature:
  // concat(originalArray[value1[, value2[, ...[, valueN]]]])

  // Return value:
  // A new array instance.

  // Function Syntax:
  function concat(originalArray, values) {
    // Create a new array.
    var resultSoFar = [];

    // Add the values in originalArray.
    for (
      var originalArrayIndex = 0;
      originalArrayIndex < originalArray.length;
      originalArrayIndex++
    ) {
      resultSoFar.push(originalArray[originalArrayIndex]);
    }

    // For all values in the array
    for (
      var argumentIndex = 1;
      argumentIndex < arguments.length;
      argumentIndex++
    ) {
      var currentArgument = arguments[argumentIndex];

      // If currentArgument is not an array:
      if (Array.isArray(currentArgument) === false) {
        resultSoFar.push(currentArgument);
      } else {
        for (var i = 0; i < currentArgument.length; i++) {
          resultSoFar.push(currentArgument[i]);
        }
      }
    }

    return resultSoFar;
  }

  tests({
    /*
    "1a) It should not modify original array.": function() {
      var originalArray = [1];
      var duplicateArray = originalArray;
      concat(originalArray, 2);
      eq(originalArray, duplicateArray);
    },
    "1b) It should not modify the values provided as arguments.": function() {
      var originalValue = 2;
      var duplicateValue = originalValue;
      concat([1], originalValue);
      eq(originalValue, duplicateValue);
    },

    "2a) It should return a new array.": function() {
      var concattedArray = concat([1], 2);
      eq(Array.isArray(concattedArray), true);
    },

    "3a) It should prepend elements in originalArray to the beginning of returnedArray.": function() {
      var originalArray = [1];
      var concattedArray = concat(originalArray, 2);
      eq(originalArray[0], concattedArray[0]);
    },
    "3b) If an argument is not an array it should append argument to originalArray.": function() {
      var originalPrimitive = "primitive";
      var concattedArray = concat([0], originalPrimitive);
      eq(originalPrimitive, concattedArray[1]);
    },
    "3c) If argument is an array, it should flatten argument and append argument to originalArray.": function() {
      var originalArray = [1, 2];
      var concattedArray = concat([0], originalArray);
      eq(originalArray[0], concattedArray[1]);
      eq(originalArray[1], concattedArray[2]);
    },

    "4a) It should append multiple arguments to originalArray in returnedArray.": function() {
      var concattedArray = concat([1], 2, 3);
      eq(concattedArray[1], 2);
      eq(concattedArray[2], 3);
    },

    "5a) It should return shallow copies of objects provided as arguments.": function() {
      var originalObject = { name: "originalObject" };
      var concattedArray = concat([1], originalObject);
      eq(concattedArray[1], originalObject);
    },
    "5b) It should not flatten nested arrays in returnedArray.": function() {
      var nestedArray = ["nestedArray"];
      var concattedArray = concat([1], [nestedArray]);
      eq(concattedArray[1][0], nestedArray);
    }
    */

    // Kevin's tests

    // Disagree with test as you always need an original array in native .concat()
    /*
    "It should return an array.": function() {
      var returnedValue = concat();
      eq(Array.isArray(returnedValue), true);
    },
    */
    "It should return a new array, not the array(s) provided as argument(s).": function() {
      var originalArray = [1, 2, 3];
      var returnedArray = concat(originalArray);
      eq(returnedArray !== originalArray, true);
    },
    "It should return a new array consisting of, in order of provided arguments, each argument's elements (for array arguments) or each argument itself (for non-array arguments).": function() {
      var arr1 = [1, 2];
      var arr2 = [3, 4];
      var returnedArray = concat(arr1, arr2);
      eq(arr1[0], returnedArray[0]);
      eq(arr1[1], returnedArray[1]);
      eq(arr2[0], returnedArray[2]);
      eq(arr2[1], returnedArray[3]);
    },
    "It should copy any object references (and not the actual objects) from the array(s) provided as argument(s) into the new array.": function() {
      var obj1 = { a: true };
      var returnedArray = concat(obj1);
      eq(returnedArray[0].a, true);
      obj1.a = false;
      eq(returnedArray[0].a, false);
    },
    "It should copy any primitive value(s) provided as argument(s) into the new array.": function() {
      var returnedArray = concat(0, "string", true);
      eq(returnedArray[0], 0);
      eq(returnedArray[1], "string");
      eq(returnedArray[2], true);
    },
    "It should not alter 'this'.": function() {
      var returnedArray = concat(this);
      eq(returnedArray[0], this);
    },
    "It should not mutate the array(s) provided as argument(s).": function() {
      var arr1 = [1, 2, 3];
      concat(arr1);
      eq(JSON.stringify(arr1), JSON.stringify([1, 2, 3]));
    },
    "It should not recurse into nested array argument(s).": function() {
      var returnedArray = concat([[0]]);
      eq(Number.isInteger(returnedArray[0]), false);
      eq(Array.isArray(returnedArray[0]), true);
    }
  });
</script>
