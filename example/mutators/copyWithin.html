<script src="../../simpletest.js"></script>
<script>
  // Summary:
  // Shallow copies part of an array to another location in the same array.

  // Example:
  // var array = ["a", "b", "c", "d"];
  //copyWithin(array, 1, 2, 3);
  // >>> ["a", "c", "c", "d"];

  // Prototype implementation:
  // function copyWithin(array, index, optionalStart, optionalEnd) {
  //   var originalLength = array.length;
  //   var numberOfIndexesToBeCopied;

  //   // Elements will not be copied if coped elements will increase length.
  //   if (index + (optionalEnd - optionalStart) > originalLength) {
  //     numberOfIndexesToBeCopied = originalLength - index;
  //   } else {
  //     numberOfIndexesToBeCopied = optionalEnd - optionalStart;
  //   }

  //   var indexesToBeCopied = [];
  //   var i = 0;

  //   // Store all elements to be copied in array.
  //   while (i < numberOfIndexesToBeCopied) {
  //     indexesToBeCopied[i] = array[optionalStart + i];
  //     i++;
  //   }

  //   var j = 0;

  //   // Add all elements to be copied to array starting at index.
  //   while (j < numberOfIndexesToBeCopied) {
  //     array[index + j] = indexesToBeCopied[j];
  //     j++;
  //   }

  //   return array;
  // }

  // Function signature:
  // copyWithin(array, index, optionalStart, optionalEnd);

  // Arguments:
  // array - The array to be modified.
  // index - The index to insert copied elements at.
  // optionalStart - The index to begin copying elements from.
  // optionalEnd - The index to stop copying elements at.

  // Return value:
  // The array that was modified.

  // Requirements:
  // Questions:
  // 1) What does shallow copy mean? https://we-are.bookmyshow.com/understanding-deep-and-shallow-copy-in-javascript-13438bad941c
  // A "shallow copy" is a copy of an object that points to the same memory address.
  // A "deep copy" is a copy of an object that is stored at a new memory address.
  // 2) What is a TypedArray? https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/copyWithin
  // A TypedArray object describes an array-like view of an underlying binary data buffer.
  // 3) What is a binary data buffer? https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer
  // The ArrayBuffer object is used to represent a generic, fixed-length raw binary data buffer.

  // Useful References:
  // 1) MDN Docs: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/copyWithin s
  // 2) Specs: https://www.ecma-international.org/ecma-262/6.0/#sec-array.prototype.copywithin
  // 3) Type Array Docs: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/copyWithin

  // Function Syntax:

  function copyWithin(array, index, optionalStart, optionalEnd) {
    var numberOfArguments = arguments.length;
    var lengthOfOriginalArray = array.length;
    var optionalStartAsNumber = Number(optionalStart);
    var indexAsNumber = Number(index);

    // Set value of indexToCopyTo:
    var indexToCopyTo;
    if (indexAsNumber < 0) {
      indexToCopyTo = lengthOfOriginalArray + indexAsNumber;
    } else {
      indexToCopyTo = indexAsNumber;
    }

    // Set value of optionalStart;
    var indexToStartCopyingFrom;
    if (optionalStartAsNumber < 0) {
      indexToStartCopyingFrom = lengthOfOriginalArray + optionalStartAsNumber;
    } else if (
      numberOfArguments > 2 &&
      optionalStartAsNumber < lengthOfOriginalArray
    ) {
      indexToStartCopyingFrom = optionalStartAsNumber;
    } else {
      indexToStartCopyingFrom = 0;
    }

    // Store list of indexes to be copied in array:
    var indexesToCopy = [];
    var i = 0;
    while (i < lengthOfOriginalArray) {
      indexesToCopy[i] = array[indexToStartCopyingFrom + i];
      i++;
    }

    // Copy values from indexesToCopy to array:
    var j = 0;
    while (j < indexesToCopy.length) {
      array[indexToCopyTo + j] = indexesToCopy[j];
      j++;
    }

    return array;
  }

  tests({
    // Basic Requirements:
    "1) It should return an array.": function() {
      var array = [];
      var returnedArray = copyWithin(array);
      eq(Object.prototype.toString.call(returnedArray), "[object Array]");
    },
    "2) It should return the same array instead of creating a new array.": function() {
      var array = [];
      var returnedArray = copyWithin(array);
      eq(array, returnedArray);
    },

    // If index is a number:
    "3a) If (index === 0 ) it should NOT copy any indexes in array.": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },
    "3b) If (index > 0) && (index < array.length), it should copy array[n], to array[n + index].": function() {
      var array = ["a", "b", "c"];
      var index = 1;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "a");
      eq(returnedArray[2], "b");
    },
    "3c) If (index > 0) && (index >= array.length), it should NOT copy any indexes in array.": function() {
      var array = ["a", "b", "c"];
      var index = 3;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },
    "3d) If (index < 0) && (index + array.length > 0), it should copy array[n] to array[array.length + index + n].": function() {
      var array = ["a", "b", "c"];
      var index = -1;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "a");
    },
    "3e) If (index < 0) && (index + array.length <= 0), it should NOT copy any indexes in array.": function() {
      var array = ["a", "b", "c"];
      var index = -3;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },

    // TODO: Remove overly cute test from suite as proceeding to fulfill requirements:

    // If index is NOT a number:
    "4a) If index is NOT a number && index can be converted to a number it should behave like Number(index).": function() {
      var array = ["a", "b", "c"];
      var index = "1";
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "a");
      eq(returnedArray[2], "b");
    },
    "4b) If index is NOT a number && index cannot be converted to a number, it should NOT copy any indexes in array.": function() {
      var array = ["a", "b", "c"];
      var index = "cow";
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },

    // If optionalStart is a number:
    "5a) If no optionalStart, the first copied index should be array[0].": function() {
      var array = ["a", "b", "c"];
      var index = 1;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[1], "a");
    },
    "5b) If (optionalStart >= 0) && (optionalStart < array.length), the first copied index should be array[optionalStart].": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = 1;
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "b");
    },
    "5c) If (optionalStart >= 0) && (optionalStart >= array.length), do NOT copy indexes.": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = 3;
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },
    "5d) If (optionalStart < 0) && (optionalStart + array.length > 0), the first copied index should be array[array.length + optionalStart].": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = -1;
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "c");
    },
    "5e) If (optionalStart < 0) && (optionalStart + array.length <= 0), do NOT copy indexes.": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = -3;
      var returnedArray = copyWithin(array, index);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },

    // If optionalStart is NOT a number:
    "6a) If optionalStart is NOT a number && optionalStart can be converted to a number, it should behave like Number(optionalStart).": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = "1";
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "b");
    },
    "6b) If optionalStart is NOT a number && optionalStart cannnot be converted to a number, it should NOT copy any indexes in array.": function() {
      var array = ["a", "b", "c"];
      var index = 0;
      var optionalStart = "cow";
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "b");
      eq(returnedArray[2], "c");
    },

    // If optionalEnd is a number:
    "7a) If no optionalEnd, all indexes after optionalStart should be copied.": function() {
      var array = ["a", "b", "c", "d"];
      var index = 1;
      var optionalStart = 0;
      var returnedArray = copyWithin(array, index, optionalStart);
      eq(returnedArray[0], "a");
      eq(returnedArray[1], "a");
      eq(returnedArray[2], "b");
      eq(returnedArray[3], "c");
    },
    "7b) If (optionalEnd >= 0) the last copied index should be array[optionalEnd - 1].": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var deepCopyOfOrginalArray = array.slice();
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedArray = copyWithin(array, index, optionalStart, optionalEnd);
      // eq(deepCopyOfOrginalArray[optionalEnd - 1] === returnedArray[index + optionalEnd - 1], true);
      // eq(deepCopyOfOrginalArray[optionalEnd] === returnedArray[index + optionalEnd], false);
    },
    "7c) If (optionalEnd < 0) && (optionalEnd + array.length > 0), the last copied index should be array[optionalEnd + array.length - 1].": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var deepCopyOfOrginalArray = array.slice();
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = -2;
      // var returnedArray = copyWithin(array, index, optionalStart, optionalEnd);
      // eq(deepCopyOfOrginalArray[optionalEnd + array.length - 1] === returnedArray[index + optionalEnd + array.length - 1], true);
      // eq(deepCopyOfOrginalArray[optionalEnd + array.length ] === returnedArray[index + optionalEnd + array.length], false);
    },
    "7d) If (optionalEnd < 0) && (optionalEnd + array.length < 0), it should NOT copy all remaining elements in array.": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var deepCopyOfOrginalArray = array.slice();
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = -3;
      // var returnedArray = copyWithin(array, index, optionalStart, optionalEnd);
      // eq(returnedArray[0], "a")
      // eq(returnedArray[1], "b")
      // eq(returnedArray[2], "c")
    },

    // If optionalEnd is NOT a number:
    "8a) If optionalEnd is NOT a number && optionalEnd can be converted to a number, it should behave like Number(optionalEnd).": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = "1";
      // var returnedArray = copyWithin(array, index, optionalStart, optionalEnd);
      // eq(returnedArray[0], "a");
      // eq(returnedArray[1], "a");
      // eq(returnedArray[2], "c");
    },
    "8b) If optionalEnd is NOT a number && optionalEnd cannnot be converted to a number, it should NOT copy any indexes in array.": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = "cow";
      // var returnedArray = copyWithin(array, index, optionalStart, optionalEnd);
      // eq(returnedArray[0], "a")
      // eq(returnedArray[1], "b")
      // eq(returnedArray[2], "c")
    },

    "9) It should never modify array.length.": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var originalLength = array.length;
      // var returnedArray = copyWithin(array, 2);
      // eq(originalLength, returnedArray.length);

      // var array = ["a", "b", "c"];
      // var originalLength = array.length;
      // var returnedArray = copyWithin(array, 2, 0);
      // eq(originalLength, returnedArray.length);

      // var array = ["a", "b", "c"];
      // var originalLength = array.length;
      // var returnedArray = copyWithin(array, 2, 0, 2);
      // eq(originalLength, returnedArray.length);

      // var array = ["a", "b", "c", "d"];
      // var originalLength = array.length;
      // var returnedArray = copyWithin(array, 3, 0, 3);
      // eq(originalLength, returnedArray.length);
    },

    "10) It should shallow copy part of array, creating a copies of objects that point to the same memory address.": function() {
      fail();
      // var object = {};
      // var array = [object, "b", "c"];
      // var returnedArray = copyWithin(array, 1);
      // object.isShallowCopyOfObject = true;
      // eq(returnedArray[1].isShallowCopyOfObject, true);
    },

    "11) If used to copy a nested array, it should not copyWithin inside of nested array.": function() {
      fail();
      // var array = [["a", "b", "c"], "b", "c"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = Array.prototype.copyWithin.call(array, index, optionalStart, optionalEnd);
      // eq(returnedValue[1][0], "a")
      // eq(returnedValue[1][1], "b")
      // eq(returnedValue[1][2], "c")
    },

    "12) It should copy holes in array.": function() {
      fail();
      // var array = ["a", , "c", "d", "e"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 3;
      // var returnedArray = copyWithin.call(array, index, optionalStart, optionalEnd);
      // eq(returnedArray[0], "a");
      // eq(returnedArray[1], "a");
      // eq(2 in returnedArray], false);
      // eq(returnedArray[3], "c");
      // eq(returnedArray[4], "e");
    },

    // When used with call() and apply():
    // Tests include all parameters:
    "13a) If used with .call() it should copyWithin().": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedArray = copyWithin.call(array, index, optionalStart, optionalEnd);
      // eq(returnedArray[0], "a");
      // eq(returnedArray[1], "a");
      // eq(returnedArray[2], "c");
    },
    "13b) If used with .apply() it should copyWithin().": function() {
      fail();
      // var array = ["a", "b", "c"];
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedArray = copyWithin.call(array, [index, optionalStart, optionalEnd]);
      // eq(returnedArray[0], "a");
      // eq(returnedArray[1], "a");
      // eq(returnedArray[2], "c");
    },

    "14a) If ('length' in object === false) it should NOT copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c"
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "b");
      // eq(returnedObject[2], "c");
    },
    "14b) If (object.length < 0) it should NOT copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: -1
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "b");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, -1);
    },
    "14c) If (object.length === 0) it should NOT copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: 0
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "b");
      // eq(returnedObject[2], "c");
    },

    "15a) If (object.length > 0) && (object.length < last index of object to be modified) it should NOT copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: 1
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "b");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, 1);
    },
    "15b) If (object.length > 0) && (object.length > last index of object to be modified) it should copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: 2
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "a");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, 2);
    },

    "15a) If (object.length === number of ennumerable properties in object) it should copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: 3
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "a");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, 3);
    },
    "15b) If (object.length > number of ennumerable properties in object) it should copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: 10
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "a");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, 10);
    },

    "16a) If (typeof(object.length) !== 'number'), and object.length cannot be converted to a number it should NOT copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: "cow"
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "b");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, "cow");
    },
    "16b) If (typeof(object.length) !== 'number'), and object.length can be converted to a number it should copyWithin().": function() {
      fail();
      // var object = {
      //   0: "a",
      //   1: "b",
      //   2: "c",
      //   length: "3"
      // };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedObject = copyWithin.call(object, index, optionalStart, optionalEnd);
      // eq(returnedObject[0], "a");
      // eq(returnedObject[1], "a");
      // eq(returnedObject[2], "c");
      // eq(returnedObject.length, "3");
    },

    "17a) If (typeof(object) === 'number'), it should create an object wrapper for object.": function() {
      fail();
      // var numberValue = 10;
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(numberValue, index, optionalStart, optionalEnd);
      // eq(typeof returnedValue, "object");
      // eq(returnedValue.valueOf(), 10);
    },
    "17b) If (typeof(object) === 'boolean'), it should create an object wrapper for object.": function() {
      fail();
      // var booleanValue = true;
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(booleanValue, index, optionalStart, optionalEnd);
      // eq(typeof returnedValue, "object");
      // eq(returnedValue.valueOf(), true);
    },
    "17c) If (typeof(object) === 'function'), it should create an object wrapper for function.": function() {
      fail();
      // var functionValue = function () { };
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(functionValue, index, optionalStart, optionalEnd);
      // eq(functionValue, returnedValue);
    },

    "18a) If (typeof(object) === 'string'), it should throw TypeError.": function() {
      fail();
      // var isTypeError = false;
      // var errorMessage;
      // try {
      // var stringValue = "cow";
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(stringValue, index, optionalStart, optionalEnd);
      // } catch(e) {
      //   isTypeError = e instanceof TypeError;
      //   errorMessage = e.message;
      // }
      //   eq(isTypeError, true);
      //   eq(
      //   errorMessage,
      //     "Cannot assign to read only property '1' of object '[object String]'"
      // );
    },
    "18b) If object is null, it should throw TypeError.": function() {
      fail();
      // var isTypeError = false;
      // var errorMessage;
      // try {
      // var nullValue = null;
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(nullValue, index, optionalStart, optionalEnd);
      // } catch(e) {
      //   isTypeError = e instanceof TypeError;
      //   errorMessage = e.message;
      // }
      //   eq(isTypeError, true);
      //   eq(
      //   errorMessage,
      //     "Cannot convert undefined or null to object"
      // );
    },
    "18c) If object is undefined, it should throw TypeError.": function() {
      fail();
      // var isTypeError = false;
      // var errorMessage;
      // try {
      // var undefinedValue = null;
      // var index = 1;
      // var optionalStart = 0;
      // var optionalEnd = 1;
      // var returnedValue = copyWithin.call(undefinedValue, index, optionalStart, optionalEnd);
      // } catch(e) {
      //   isTypeError = e instanceof TypeError;
      //   errorMessage = e.message;
      // }
      //   eq(isTypeError, true);
      //   eq(
      //   errorMessage,
      //     "Cannot convert undefined or null to object"
      // );
    }
  });
</script>
