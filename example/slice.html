<script src="../simpletest.js"></script>
<script>
  // Summary:
  // Returns a new array that is a shallow copy of originalArray by extracting a portion of originalArray.

  // Prototype implementation:

  // Function signature:
  // slice(originalArray, optionalStart, optionalEnd)

  // Arguments:
  // optionalStart - Starting point for extraction.
  // optionalEnd - Ending point for extraction.

  // Return value:
  // A new array.

  // Function Syntax:

  function slice(originalArray, optionalStart, optionalEnd) {
    //TODO: Refactor code to use computedIndex.
    var originalStartingIndex = 0;
    var originalLength = originalArray.length;
    var originalStoppingIndex = originalLength;

    // If optionalStart
    if (arguments.length > 1) {
      if (optionalStart < 0) {
        if (optionalStart + originalLength < 0) {
          originalStartingIndex = 0;
        } else {
          originalStartingIndex = originalLength + optionalStart;
        }
      } else {
        originalStartingIndex = optionalStart;
      }
    }

    // If optionalEnd
    if (arguments.length > 2) {
      if (optionalEnd < 0) {
        originalStoppingIndex = originalLength + optionalEnd;
      }
      if (optionalEnd > 0 && optionalEnd < originalLength) {
        originalStoppingIndex = optionalEnd;
      }
    }

    if (optionalStart > originalLength) {
      return [];
    }

    // Calculate length of slicedArray after setting final start and stop values:
    var slicedArray;
    var slicedArrayLength = originalStoppingIndex - originalStartingIndex;
    slicedArray = new Array(slicedArrayLength);

    // For every value that should be copied:
    var slicedArrayIndex = 0;
    for (var i = originalStartingIndex; i < originalStoppingIndex; i++) {
      if (i in originalArray) {
        var elementToCopy = originalArray[i];
        slicedArray[slicedArrayIndex] = elementToCopy;
      }

      slicedArrayIndex++;
    }

    return slicedArray;
  }

  tests({
    "1a) It should not modify originalArray.": function() {
      var originalArray = [0];
      var duplicateArray = originalArray;
      slice(originalArray);
      eq(duplicateArray, originalArray);
    },
    "1b) It should return an array.": function() {
      var slicedArray = slice([0]);
      eq(Array.isArray(slicedArray), true);
    },
    "1c) It should return an array that is not equal to originalArray.": function() {
      var originalArray = [0];
      var slicedArray = slice(originalArray);
      eq(slicedArray !== originalArray, true);
    },

    "2a) It should return a shallow copy of elements from originalArray.": function() {
      var testObject = {};
      var testArray = [0, testObject];
      var slicedArray = slice(testArray);
      eq(slicedArray[0], 0);
      eq(slicedArray[1], testArray[1]);
    },

    "3a) It should copy holes to newArray.": function() {
      var slicedArray = slice([, 1, , 2, , 3]);
      var slicedArrayTwo = slice([, 1, ,]);
      eq(slicedArray.hasOwnProperty(0), false);
      eq(slicedArray.length, 6);
      eq(slicedArrayTwo.length, 3);
    },

    "3a) If no optionalStart, begin extraction at index 0.": function() {
      var slicedArray = slice([0, 1]);
      eq(slicedArray.length, 2);
    },

    "4a) If optionalStart < originalLength, begin extraction at originalArray[optionalStart].": function() {
      var slicedArray = slice([0, 1], 1);
      eq(slicedArray.length, 1);
    },
    "4b) If optionalStart > originalLength, return an empty array.": function() {
      var slicedArray = slice([0, 1], 10);
      eq(slicedArray.length, 0);
    },
    "4c) If optionalStart < 0 and optionalStart + originalLength > 0, begin extraction at originalLength + optionalStart.": function() {
      var slicedArray = slice([0, 1], -1);
      eq(slicedArray.length, 1);
    },
    "4d) If optionalStart < 0 and optionalStart + originalLength < 0, slice begins from index 0.": function() {
      var slicedArray = slice([1, 2, 3], -6);
      eq(slicedArray.length, 3);
    },

    "5a) If no optionalEnd, extract all remaining values in originalArray.": function() {
      var slicedArray = slice([0, 1], 1);
      eq(slicedArray.length, 1);
    },

    "6a) If optionalEnd < originalLength, last extracted value should be originalArray[optionalEnd -1].": function() {
      var slicedArray = slice([0, 1], 0, 1);
      eq(slicedArray.length, 1);
    },
    "6b) If optionalEnd > originalLength, extract all remaining values in originalArray.": function() {
      var slicedArray = slice([0, 1], 0, 10);
      eq(slicedArray.length, 2);
    },
    "6c) If optionalEnd < 0, end extraction at originalLength + optionalEnd.": function() {
      var slicedArray = slice([0, 1], 0, -1);
      eq(slicedArray.length, 1);
    }
  });
</script>
